<app-layout title="Dashboard" subtitle="Welcome back! Here's what's happening.">
  <!-- Stats Grid (unchanged) -->
  <div class="stats-grid">
    <div class="stat-card" routerLink="/admins">
      <div class="stat-icon purple">
        <mat-icon>people</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-label">Total Admins</div>
        <div class="stat-value">{{ adminCount }}</div>
        <div class="stat-change positive">
          <mat-icon>trending_up</mat-icon>
          <span>View all</span>
        </div>
      </div>
    </div>

    <div class="stat-card" routerLink="/complexes">
      <div class="stat-icon blue">
        <mat-icon>location_city</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-label">Complexes</div>
        <div class="stat-value">{{ complexCount }}</div>
        <div class="stat-change positive">
          <mat-icon>trending_up</mat-icon>
          <span>View all</span>
        </div>
      </div>
    </div>

    <div class="stat-card" routerLink="/buildings">
      <div class="stat-icon green">
        <mat-icon>business</mat-icon>
      </div>
      <div class="stat-content">
        <div class="stat-label">Buildings</div>
        <div class="stat-value">{{ buildingCount }}</div>
        <div class="stat-change positive">
          <mat-icon>trending_up</mat-icon>
          <span>View all</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="section">
    <div class="section-header">
      <h2 class="section-title">Quick Actions</h2>
      <p class="section-subtitle">Tasks available based on your role</p>
    </div>

    <div class="action-cards">
      <ng-container *ngFor="let action of quickActions">
        <button
          *ngIf="!action.permission || authService.can(action.permission)"
          class="action-card"
          [routerLink]="action.route"
        >
          <div class="action-icon" [ngClass]="action.color">
            <mat-icon>{{ action.icon }}</mat-icon>
          </div>
          <div class="action-content">
            <div class="action-title">{{ action.title }}</div>
            <div class="action-description">{{ action.description }}</div>
          </div>
          <mat-icon class="action-arrow">arrow_forward</mat-icon>
        </button>
      </ng-container>
    </div>
  </div>

  <!-- Getting Started - Updated -->
  <div class="section">
    <div class="section-header">
      <div>
        <h2 class="section-title">Getting Started</h2>
        <p class="section-subtitle">
          <span *ngIf="!isFullySetup"
            >Complete these steps to fully set up your system</span
          >
          <span *ngIf="isFullySetup"
            >ðŸŽ‰ All set up! Your system is ready to use</span
          >
        </p>
      </div>
      <div class="progress-badge" [ngClass]="{ completed: isFullySetup }">
        <mat-icon>{{ isFullySetup ? "check_circle" : "pending" }}</mat-icon>
        <span>{{ completionPercentage }}% Complete</span>
      </div>
    </div>

    <div class="checklist-card">
      <!-- Step 1: Account Created (Always completed) -->
      <div class="checklist-item completed">
        <div class="checklist-icon">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="checklist-content">
          <div class="checklist-title">Account Created</div>
          <div class="checklist-description">
            Your account is active and ready
          </div>
        </div>
        <div class="checklist-badge">Completed</div>
      </div>

      <!-- Step 2: Create Complex -->
      <div
        class="checklist-item"
        [ngClass]="{ completed: hasComplexes, pending: !hasComplexes }"
      >
        <div class="checklist-icon">
          <mat-icon>{{
            hasComplexes ? "check_circle" : "radio_button_unchecked"
          }}</mat-icon>
        </div>
        <div class="checklist-content">
          <div class="checklist-title">
            {{
              hasComplexes ? "Complexes Created" : "Create Your First Complex"
            }}
          </div>
          <div class="checklist-description">
            <span *ngIf="!hasComplexes"
              >Add a residential complex (automatically creates a Complex
              Admin)</span
            >
            <span *ngIf="hasComplexes"
              >You have {{ complexCount }} complex{{
                complexCount !== 1 ? "es" : ""
              }}</span
            >
          </div>
        </div>
        <button
          *ngIf="!hasComplexes"
          mat-raised-button
          color="primary"
          routerLink="/complexes/create"
        >
          Create
        </button>
        <div *ngIf="hasComplexes" class="checklist-badge">Completed</div>
      </div>

      <!-- Step 3: Add Buildings -->
      <div
        class="checklist-item"
        [ngClass]="{
          completed: hasBuildings,
          pending: !hasBuildings,
          disabled: !hasComplexes
        }"
      >
        <div class="checklist-icon">
          <mat-icon>{{
            hasBuildings ? "check_circle" : "radio_button_unchecked"
          }}</mat-icon>
        </div>
        <div class="checklist-content">
          <div class="checklist-title">
            {{ hasBuildings ? "Buildings Added" : "Add Buildings" }}
          </div>
          <div class="checklist-description">
            <span *ngIf="!hasBuildings && hasComplexes"
              >Add buildings to complexes (automatically creates Building
              Admins)</span
            >
            <span *ngIf="!hasBuildings && !hasComplexes"
              >Create a complex first before adding buildings</span
            >
            <span *ngIf="hasBuildings"
              >You have {{ buildingCount }} building{{
                buildingCount !== 1 ? "s" : ""
              }}</span
            >
          </div>
        </div>
        <button
          *ngIf="!hasBuildings && hasComplexes"
          mat-raised-button
          color="primary"
          routerLink="/buildings/create"
        >
          Add Building
        </button>
        <div *ngIf="hasBuildings" class="checklist-badge">Completed</div>
      </div>

      <!-- Celebration Message (When all done) -->
      <div *ngIf="isFullySetup" class="celebration-box">
        <mat-icon>celebration</mat-icon>
        <div>
          <strong>Congratulations!</strong>
          <p>
            Your system is fully configured. You now have
            {{ adminCount }} administrators managing
            {{ complexCount }} complexes with {{ buildingCount }} buildings.
          </p>
        </div>
      </div>

      <!-- Info Box about Admin Creation -->
      <div class="info-box-section">
        <mat-icon>info</mat-icon>
        <div>
          <strong>About Admin Creation</strong>
          <ul>
            <li>
              <strong>Automatic:</strong> When you create a complex or building,
              an admin is automatically created for it
            </li>
            <li *ngIf="isSuperAdmin">
              <strong>Manual:</strong> As Super Admin, you can manually create
              admins with specific roles using the "Create Admin" button
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</app-layout>
