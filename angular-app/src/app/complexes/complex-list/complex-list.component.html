<app-layout title="Complexes" subtitle="Manage residential complexes">
  <div header-actions>
    <button
      *ngIf="authService.can('create_complex')"
      mat-raised-button
      color="primary"
      routerLink="/complexes/create"
    >
      <mat-icon>add</mat-icon>
      Add Complex
    </button>
  </div>

  <div *ngIf="isBuildingAdmin && currentUserBuilding" class="info-banner">
    <mat-icon>info</mat-icon>
    <span>
      You are assigned to: <strong>{{ currentUserBuilding.name }}</strong> in
      <strong>{{ getComplexName(currentUserBuilding.complex_id) }}</strong>
    </span>
  </div>

  <!-- Empty State -->
  <div *ngIf="complexes.length === 0" class="empty-state">
    <mat-icon>location_city</mat-icon>
    <h3>No complexes available</h3>
    <p>Create your first residential complex to get started</p>
    <button mat-raised-button color="primary" routerLink="/complexes/create">
      <mat-icon>add</mat-icon>
      Create Complex
    </button>
  </div>

  <!-- Complex Cards Grid -->
  <div *ngIf="complexes.length > 0" class="complex-grid">
    <div
      class="complex-card"
      *ngFor="let complex of complexes"
      [routerLink]="['/complexes', complex.id]"
    >
      <!-- Card Header -->
      <div class="complex-card-header">
        <div class="complex-icon">
          <mat-icon>location_city</mat-icon>
        </div>
        <div class="complex-header-content">
          <h3 class="complex-title">{{ complex.identity }}</h3>
          <div class="complex-address">
            <mat-icon>place</mat-icon>
            <span>{{ complex.address }}</span>
          </div>
        </div>
        <mat-icon class="complex-arrow">arrow_forward</mat-icon>
      </div>

      <!-- Card Footer with Meta Info -->
      <div class="complex-card-footer">
        <div class="meta-item" *ngIf="complex.campaign_start">
          <mat-icon>event</mat-icon>
          <span>
            <span class="meta-item-label">Started</span>
            {{ complex.campaign_start | date : "MMM d, y" }}
          </span>
        </div>
        <div class="meta-item" *ngIf="shouldShowBuildingCount(complex.id)">
          <mat-icon>business</mat-icon>
          <span>
            {{ getBuildingCount(complex.id) }}
            {{ getBuildingCount(complex.id) === 1 ? "Building" : "Buildings" }}
          </span>
        </div>
      </div>
    </div>
  </div>
</app-layout>
